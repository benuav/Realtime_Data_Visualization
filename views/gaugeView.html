
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" href="../css/gauge.css">
    <link rel="stylesheet" href="../css/style.css">

    <title>Sugarcane AI System Interface</title>
</head>


<ul>
    <li><a href="index.html">Home</a></li>
    <li><a href="gaugeView.html">Gauge</a></li>
    <li><a href="mapView.html">Map</a></li>
    <li><a href="setView.html">Setting</a></li>
  </ul>
 

    <body>
        <h1>Prototype No.1</h1>

        <div class="gauge">
            <div class="gauge__body">
              <div class="gauge__fill"></div>
              <div class="gauge__cover">15</div>
           </div>
        </div>
       


        <script>
            

            const gaugeElement = document.querySelector(".gauge");
            
            function setGaugeValue(gauge, value){
                if (value < 0 || value > 15){
                    return;
                }
                gauge.querySelector(".gauge__fill").style.transform = `rotate(${value / 30}turn`;
               /* gauge.querySelector(".gauge__cover").textContent = `${Math.round(value * 100)}%`;*/
                gauge.querySelector(".gauge__cover").textContent = `${(value)}`;
            }



            var a = [];
            setInterval(getData, 1000) // run get Data function every 1 second
            //getData();

            
            async function getData(){
                const response = await fetch('../data/data.csv');
                const data = await response.text();
                //console.log(data);

                const rows = data.split('\n').slice(1);
                rows.forEach(elt => {
                    const row = elt.split(',');
                    const number = row[4];

                    a.push(number);
                //   console.log(a);   

                ///   console.log(row);
                    //console.log(number);
                ///  setGaugeValue(gaugeElement, number);
                });
               // console.log("this is number", a); // the var a must within the getDATA FUCNITON 
                var lastItem = a[a.length -2]; //choose the last number to display
                console.log("this is last item", lastItem);
                setGaugeValue(gaugeElement, lastItem); // run setGauge when eachtime get the data.
            //    setTimeout (setGaugeValue(gaugeElement, lastItem), 3000);
                /// console.log(rows);
            };

            



        </script>



    </body>
</html>
